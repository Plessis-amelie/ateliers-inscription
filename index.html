
<!DOCTYPE html>
<html lang='fr'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>Inscription aux ateliers</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; }
        form { max-width: 400px; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        label { display: block; margin-top: 10px; }
        input, select { width: 100%; padding: 8px; margin-top: 5px; }
        button { margin-top: 15px; padding: 10px; background-color: #0078D7; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:disabled { background-color: #ccc; }
        .message { margin-top: 15px; font-weight: bold; }
        .export-btn { background-color: #28a745; }
    </style>
</head>
<body>
    <h1>Inscription aux ateliers</h1>
    <form id='inscriptionForm'>
        <label for='nom'>Nom et prénom :</label>
        <input type='text' id='nom' name='nom' required>

        <label for='classe'>Classe :</label>
        <input type='text' id='classe' name='classe' required>

        <label for='atelier'>Choix de l'atelier :</label>
        <select id='atelier' name='atelier' required>
            <option value='Atelier 1'>Atelier 1</option>
            <option value='Atelier 2'>Atelier 2</option>
            <option value='Atelier 3'>Atelier 3</option>
        </select>

        <button type='submit'>S'inscrire</button>
        <div class='message' id='message'></div>
    </form>

    <button class='export-btn' onclick='exportCSV()'>Exporter les inscriptions en CSV</button>

    <script>
        // Limites par atelier (modifiable facilement)
        const limites = { 'Atelier 1': 15, 'Atelier 2': 15, 'Atelier 3': 15 };
        let inscriptions = JSON.parse(localStorage.getItem('inscriptions')) || { 'Atelier 1': [], 'Atelier 2': [], 'Atelier 3': [] };

        document.getElementById('inscriptionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const nom = document.getElementById('nom').value.trim();
            const classe = document.getElementById('classe').value.trim();
            const atelier = document.getElementById('atelier').value;

            if (inscriptions[atelier].length >= limites[atelier]) {
                document.getElementById('message').textContent = `Désolé, ${atelier} est complet.`;
                document.getElementById('message').style.color = 'red';
                return;
            }

            inscriptions[atelier].push({ nom, classe });
            document.getElementById('message').textContent = `Inscription réussie pour ${atelier}. Places restantes : ${limites[atelier] - inscriptions[atelier].length}`;
            document.getElementById('message').style.color = 'green';

            // Réinitialiser le formulaire
            document.getElementById('inscriptionForm').reset();

            // Sauvegarde locale (JSON)
            localStorage.setItem('inscriptions', JSON.stringify(inscriptions));
        });

        function exportCSV() {
            let csvContent = 'data:text/csv;charset=utf-8,Nom;Classe;Atelier
';
            for (let atelier in inscriptions) {
                inscriptions[atelier].forEach(entry => {
                    csvContent += `${entry.nom};${entry.classe};${atelier}
`;
                });
            }
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'inscriptions.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
